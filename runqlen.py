import re
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import make_pipeline
from sklearn.metrics import accuracy_score

# 函数：从字符串中提取runqlen的计数
def extract_features(text):
    pattern = r'(\d+)\s+:\s+(\d+)'
    matches = re.findall(pattern, text)
    features = [0] * 100  # 假设runqlen最大为100
    for match in matches:
        index, count = int(match[0]), int(match[1])
        if index < len(features):
            features[index] = count
    return features

# 训练数据
raw_texts = """
"     runqlen       : count     distribution
        0          : 1925     |****************************************|
        1          : 2        |                                        |
        2          : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 1925     |****************************************|
        1          : 2        |                                        |
        2          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1940     |****************************************|
        1          : 25       |                                        |
"
"     runqlen       : count     distribution
        0          : 1917     |****************************************|
        1          : 17       |                                        |
        2          : 2        |                                        |"
"     runqlen       : count     distribution
        0          : 1891     |****************************************|
        1          : 43       |                                        |
        2          : 3        |                                        |
        3          : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 1910     |****************************************|
        1          : 49       |*                                       |
        2          : 2        |                                        |"
"     runqlen       : count     distribution
        0          : 749      |****************************************|
        1          : 212      |***********                             |
        2          : 181      |*********                               |
        3          : 344      |******************                      |
        4          : 444      |***********************                 |
        5          : 22       |*                                       |
        6          : 9        |                                        |"
"     runqlen       : count     distribution
        0          : 787      |****************************************|
        1          : 134      |******                                  |
        2          : 234      |***********                             |
        3          : 413      |********************                    |
        4          : 365      |******************                      |
        5          : 27       |*                                       |
        6          : 6        |                                        |
"
"     runqlen       : count     distribution
        0          : 808      |****************************************|
        1          : 217      |**********                              |
        2          : 136      |******                                  |
        3          : 312      |***************                         |
        4          : 460      |**********************                  |
        5          : 20       |                                        |
        6          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 536      |****************************************|
        1          : 284      |*********************                   |
        2          : 364      |***************************             |
        3          : 507      |*************************************   |
        4          : 243      |******************                      |
        5          : 29       |**                                      |
        6          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 742      |****************************************|
        1          : 194      |**********                              |
        2          : 258      |*************                           |
        3          : 474      |*************************               |
        4          : 275      |**************                          |
        5          : 9        |                                        |
        6          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 679      |****************************************|
        1          : 287      |****************                        |
        2          : 352      |********************                    |
        3          : 513      |******************************          |
        4          : 111      |******                                  |
        5          : 18       |*                                       |
        6          : 5        |                                        |
        7          : 3        |                                        |
        8          : 0        |                                        |
        9          : 0        |                                        |
        10         : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 507      |****************************************|
        1          : 283      |**********************                  |
        2          : 234      |******************                      |
        3          : 312      |************************                |
        4          : 320      |*************************               |
        5          : 157      |************                            |
        6          : 60       |****                                    |
        7          : 25       |*                                       |
        8          : 9        |                                        |
        9          : 8        |                                        |
"
"     runqlen       : count     distribution
        0          : 460      |********************************        |
        1          : 570      |****************************************|
        2          : 532      |*************************************   |
        3          : 265      |******************                      |
        4          : 138      |*********                               |
        5          : 2        |                                        |
        6          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1136     |****************************************|
        1          : 310      |**********                              |
        2          : 381      |*************                           |
        3          : 104      |***                                     |
        4          : 38       |*                                       |
        5          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1240     |****************************************|
        1          : 235      |*******                                 |
        2          : 382      |************                            |
        3          : 92       |**                                      |
        4          : 12       |                                        |
        5          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1201     |****************************************|
        1          : 209      |******                                  |
        2          : 241      |********                                |
        3          : 282      |*********                               |
        4          : 6        |                                        |
        5          : 11       |                                        |
"
"     runqlen       : count     distribution
        0          : 760      |****************************************|
        1          : 354      |******************                      |
        2          : 345      |******************                      |
        3          : 230      |************                            |
        4          : 162      |********                                |
        5          : 63       |***                                     |
        6          : 22       |*                                       |
        7          : 9        |                                        |
        8          : 2        |                                        |
        9          : 0        |                                        |
        10         : 1        |                                        |
        11         : 0        |                                        |
        12         : 2        |                                        |
        13         : 2        |                                        |
"
"     runqlen       : count     distribution
        0          : 987      |****************************************|
        1          : 360      |**************                          |
        2          : 207      |********                                |
        3          : 271      |**********                              |
        4          : 56       |**                                      |
        5          : 31       |*                                       |
        6          : 29       |*                                       |
        7          : 16       |                                        |
        8          : 3        |                                        |
        9          : 2        |                                        |
        10         : 1        |                                        |
        11         : 0        |                                        |
        12         : 0        |                                        |
        13         : 0        |                                        |
        14         : 0        |                                        |
        15         : 0        |                                        |
        16         : 0        |                                        |
        17         : 1        |                                        |
        18         : 0        |                                        |
        19         : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1095     |****************************************|
        1          : 362      |*************                           |
        2          : 375      |*************                           |
        3          : 114      |****                                    |
        4          : 14       |                                        |
"
"     runqlen       : count     distribution
        0          : 1199     |****************************************|
        1          : 124      |****                                    |
        2          : 44       |*                                       |
        3          : 28       |                                        |
        4          : 28       |                                        |
        5          : 112      |***                                     |
        6          : 103      |***                                     |
        7          : 276      |*********                               |
        8          : 50       |*                                       |
        9          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 830      |****************************************|
        1          : 158      |*******                                 |
        2          : 145      |******                                  |
        3          : 163      |*******                                 |
        4          : 152      |*******                                 |
        5          : 81       |***                                     |
        6          : 130      |******                                  |
        7          : 195      |*********                               |
        8          : 75       |***                                     |
        9          : 34       |*                                       |
        10         : 0        |                                        |
        11         : 1        |                                        |
        12         : 0        |                                        |
        13         : 0        |                                        |
        14         : 0        |                                        |
        15         : 0        |                                        |
        16         : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 838      |****************************************|
        1          : 261      |************                            |
        2          : 258      |************                            |
        3          : 169      |********                                |
        4          : 128      |******                                  |
        5          : 95       |****                                    |
        6          : 113      |*****                                   |
        7          : 110      |*****                                   |
        8          : 2        |                                        |
"
"     runqlen       : count     distribution
        0          : 737      |****************************************|
        1          : 285      |***************                         |
        2          : 103      |*****                                   |
        3          : 132      |*******                                 |
        4          : 136      |*******                                 |
        5          : 101      |*****                                   |
        6          : 146      |*******                                 |
        7          : 268      |**************                          |
        8          : 63       |***                                     |
        9          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1214     |****************************************|
        1          : 204      |******                                  |
        2          : 115      |***                                     |
        3          : 223      |*******                                 |
        4          : 181      |*****                                   |
        5          : 8        |                                        |
"
"     runqlen       : count     distribution
        0          : 620      |****************************************|
        1          : 122      |*******                                 |
        2          : 197      |************                            |
        3          : 120      |*******                                 |
        4          : 176      |***********                             |
        5          : 19       |*                                       |
        6          : 66       |****                                    |
        7          : 100      |******                                  |
        8          : 243      |***************                         |
        9          : 274      |*****************                       |
        10         : 26       |*                                       |
        11         : 7        |                                        |
"
"     runqlen       : count     distribution
        0          : 199      |****************                        |
        1          : 195      |****************                        |
        2          : 416      |***********************************     |
        3          : 475      |****************************************|
        4          : 379      |*******************************         |
        5          : 181      |***************                         |
        6          : 46       |***                                     |
        7          : 19       |*                                       |
        8          : 9        |                                        |
        9          : 13       |*                                       |
        10         : 8        |                                        |
        11         : 11       |                                        |
"
"     runqlen       : count     distribution
        0          : 597      |****************************************|
        1          : 165      |***********                             |
        2          : 247      |****************                        |
        3          : 488      |********************************        |
        4          : 443      |*****************************           |
        5          : 20       |*                                       |
        6          : 3        |                                        |
"
"     runqlen       : count     distribution
        0          : 538      |*********************************       |
        1          : 634      |****************************************|
        2          : 492      |*******************************         |
        3          : 230      |**************                          |
        4          : 67       |****                                    |
        5          : 5        |                                        |
"
"     runqlen       : count     distribution
        0          : 566      |****************************************|
        1          : 132      |*********                               |
        2          : 74       |*****                                   |
        3          : 164      |***********                             |
        4          : 367      |*************************               |
        5          : 487      |**********************************      |
        6          : 143      |**********                              |
        7          : 20       |*                                       |
        8          : 2        |                                        |
        9          : 9        |                                        |
"
"     runqlen       : count     distribution
        0          : 265      |**********                              |
        1          : 114      |****                                    |
        2          : 96       |***                                     |
        3          : 368      |**************                          |
        4          : 1048     |****************************************|
        5          : 56       |**                                      |
        6          : 3        |                                        |
        7          : 11       |                                        |
        8          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 274      |************************                |
        1          : 399      |***********************************     |
        2          : 396      |**********************************      |
        3          : 399      |***********************************     |
        4          : 453      |****************************************|
        5          : 22       |*                                       |
        6          : 7        |                                        |
        7          : 19       |*                                       |
"
"     runqlen       : count     distribution
        0          : 335      |*********************                   |
        1          : 380      |************************                |
        2          : 398      |*************************               |
        3          : 216      |*************                           |
        4          : 619      |****************************************|
        5          : 21       |*                                       |
        6          : 3        |                                        |
        7          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 77       |*****                                   |
        1          : 312      |***********************                 |
        2          : 468      |***********************************     |
        3          : 531      |****************************************|
        4          : 330      |************************                |
        5          : 169      |************                            |
        6          : 80       |******                                  |
        7          : 8        |                                        |
"
"     runqlen       : count     distribution
        0          : 441      |**************************************  |
        1          : 154      |*************                           |
        2          : 116      |**********                              |
        3          : 208      |******************                      |
        4          : 456      |****************************************|
        5          : 57       |*****                                   |
        6          : 109      |*********                               |
        7          : 191      |****************                        |
        8          : 167      |**************                          |
        9          : 52       |****                                    |
        10         : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 197      |*********                               |
        1          : 479      |***********************                 |
        2          : 814      |****************************************|
        3          : 411      |********************                    |
        4          : 57       |**                                      |
        5          : 9        |                                        |
"
"     runqlen       : count     distribution
        0          : 361      |************************                |
        1          : 593      |****************************************|
        2          : 542      |************************************    |
        3          : 214      |**************                          |
        4          : 239      |****************                        |
        5          : 19       |*                                       |
"
"     runqlen       : count     distribution
        0          : 217      |*************                           |
        1          : 662      |****************************************|
        2          : 584      |***********************************     |
        3          : 377      |**********************                  |
        4          : 127      |*******                                 |
        5          : 2        |                                        |

"
"     runqlen       : count     distribution
        0          : 76       |*****                                   |
        1          : 308      |********************                    |
        2          : 587      |****************************************|
        3          : 467      |*******************************         |
        4          : 350      |***********************                 |
        5          : 119      |********                                |
        6          : 28       |*                                       |
        7          : 14       |                                        |
        8          : 4        |                                        |
        9          : 2        |                                        |
        10         : 1        |                                        |
        11         : 0        |                                        |
        12         : 4        |                                        |
        13         : 0        |                                        |
        14         : 1        |                                        |
"
"
     runqlen       : count     distribution
        0          : 438      |*****************                       |
        1          : 975      |****************************************|
        2          : 543      |**********************                  |
        3          : 11       |                                        |
        4          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 447      |******************                      |
        1          : 976      |****************************************|
        2          : 516      |*********************                   |
        3          : 24       |                                        |
        4          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 189      |******                                  |
        1          : 227      |*******                                 |
        2          : 346      |***********                             |
        3          : 1157     |****************************************|
        4          : 41       |*                                       |
        5          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 263      |*******                                 |
        1          : 17       |                                        |
        2          : 6        |                                        |
        3          : 24       |                                        |
        4          : 1493     |****************************************|
        5          : 110      |**                                      |
        6          : 19       |                                        |
        7          : 4        |                                        |
"
"     runqlen       : count     distribution
        0          : 16       |                                        |
        1          : 2        |                                        |
        2          : 6        |                                        |
        3          : 14       |                                        |
        4          : 995      |****************************************|
        5          : 688      |***************************             |
        6          : 153      |******                                  |
        7          : 45       |*                                       |
        8          : 22       |                                        |
        9          : 1        |                                        |
        10         : 4        |                                        |
        11         : 8        |                                        |
        12         : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 101      |********                                |
        1          : 342      |***************************             |
        2          : 404      |********************************        |
        3          : 501      |****************************************|
        4          : 372      |*****************************           |
        5          : 223      |*****************                       |
        6          : 19       |*                                       |
        7          : 6        |                                        |
"
"     runqlen       : count     distribution
        0          : 157      |********                                |
        1          : 115      |******                                  |
        2          : 99       |*****                                   |
        3          : 64       |***                                     |
        4          : 62       |***                                     |
        5          : 154      |********                                |
        6          : 516      |*****************************           |
        7          : 702      |****************************************|
        8          : 76       |****                                    |
        9          : 9        |                                        |
"
"     runqlen       : count     distribution
        0          : 82       |******                                  |
        1          : 157      |***********                             |
        2          : 405      |******************************          |
        3          : 529      |****************************************|
        4          : 450      |**********************************      |
        5          : 259      |*******************                     |
        6          : 62       |****                                    |
        7          : 3        |                                        |
"
"     runqlen       : count     distribution
        0          : 28       |**                                      |
        1          : 105      |********                                |
        2          : 146      |***********                             |
        3          : 504      |****************************************|
        4          : 361      |****************************            |
        5          : 428      |*********************************       |
        6          : 360      |****************************            |
        7          : 32       |**                                      |
        8          : 2        |                                        |
        9          : 2        |                                        |"
"     runqlen       : count     distribution
        0          : 64       |****                                    |
        1          : 129      |*********                               |
        2          : 279      |********************                    |
        3          : 550      |****************************************|
        4          : 326      |***********************                 |
        5          : 268      |*******************                     |
        6          : 297      |*********************                   |
        7          : 56       |****                                    |
"
"     runqlen       : count     distribution
        0          : 3        |                                        |
        1          : 7        |                                        |
        2          : 169      |******                                  |
        3          : 477      |******************                      |
        4          : 1018     |****************************************|
        5          : 289      |***********                             |
        6          : 6        |                                        |
        7          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 441      |**************************************  |
        1          : 154      |*************                           |
        2          : 116      |**********                              |
        3          : 208      |******************                      |
        4          : 456      |****************************************|
        5          : 57       |*****                                   |
        6          : 109      |*********                               |
        7          : 191      |****************                        |
        8          : 167      |**************                          |
        9          : 52       |****                                    |
        10         : 1        |                                        |
"
"     runqlen       : count     distribution
        1          : 1        |                                        |
        2          : 0        |                                        |
        3          : 7        |                                        |
        4          : 968      |****************************************|
        5          : 147      |******                                  |
        6          : 48       |*                                       |
        7          : 43       |*                                       |
        8          : 168      |******                                  |
        9          : 545      |**********************                  |
        10         : 37       |*                                       |
        11         : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 1        |                                        |
        1          : 5        |                                        |
        2          : 3        |                                        |
        3          : 3        |                                        |
        4          : 10       |                                        |
        5          : 381      |************************                |
        6          : 388      |*************************               |
        7          : 459      |******************************          |
        8          : 610      |****************************************|
        9          : 88       |*****                                   |
        10         : 11       |                                        |
        11         : 3        |                                        |
        12         : 5        |                                        |"
"     runqlen       : count     distribution
        0          : 5        |                                        |
        1          : 5        |                                        |
        2          : 0        |                                        |
        3          : 2        |                                        |
        4          : 9        |                                        |
        5          : 111      |*****                                   |
        6          : 758      |**************************************  |
        7          : 791      |****************************************|
        8          : 214      |**********                              |
        9          : 60       |***                                     |
        10         : 3        |                                        |
        11         : 3        |                                        |
        12         : 0        |                                        |
        13         : 3        |                                        |"
"     runqlen       : count     distribution
        0          : 1        |                                        |
        1          : 0        |                                        |
        2          : 0        |                                        |
        3          : 8        |                                        |
        4          : 473      |************************************    |
        5          : 519      |****************************************|
        6          : 268      |********************                    |
        7          : 129      |*********                               |
        8          : 246      |******************                      |
        9          : 323      |************************                |
        10         : 7        |                                        |"
"     runqlen       : count     distribution
        0          : 2        |                                        |
        1          : 4        |                                        |
        2          : 2        |                                        |
        3          : 3        |                                        |
        4          : 104      |********                                |
        5          : 307      |************************                |
        6          : 433      |**********************************      |
        7          : 478      |**************************************  |
        8          : 497      |****************************************|
        9          : 133      |**********                              |
        10         : 1        |                                        |
        11         : 7        |                                        |
"
"     runqlen       : count     distribution
        0          : 3        |                                        |
        1          : 1        |                                        |
        2          : 0        |                                        |
        3          : 0        |                                        |
        4          : 238      |*********************                   |
        5          : 406      |*************************************   |
        6          : 436      |****************************************|
        7          : 345      |*******************************         |
        8          : 312      |****************************            |
        9          : 207      |******************                      |
        10         : 11       |*                                       |
        11         : 9        |                                        |
"
"     runqlen       : count     distribution
        0          : 681      |*************************************** |
        1          : 19       |*                                       |
        2          : 18       |*                                       |
        3          : 13       |                                        |
        4          : 9        |                                        |
        5          : 14       |                                        |
        6          : 20       |*                                       |
        7          : 108      |******                                  |
        8          : 324      |******************                      |
        9          : 696      |****************************************|
"
"     runqlen       : count     distribution
        0          : 4        |                                        |
        1          : 1        |                                        |
        2          : 10       |                                        |
        3          : 4        |                                        |
        4          : 381      |*******************************         |
        5          : 491      |****************************************|
        6          : 293      |***********************                 |
        7          : 239      |*******************                     |
        8          : 349      |****************************            |
        9          : 197      |****************                        |
        10         : 2        |                                        |
"
"     runqlen       : count     distribution
        0          : 292      |**************************              |
        1          : 194      |*****************                       |
        2          : 71       |******                                  |
        3          : 60       |*****                                   |
        4          : 72       |******                                  |
        5          : 101      |*********                               |
        6          : 129      |***********                             |
        7          : 168      |***************                         |
        8          : 445      |****************************************|
        9          : 358      |********************************        |
        10         : 32       |**                                      |
        11         : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 1        |                                        |
        1          : 4        |                                        |
        2          : 5        |                                        |
        3          : 0        |                                        |
        4          : 142      |*********                               |
        5          : 599      |****************************************|
        6          : 221      |**************                          |
        7          : 348      |***********************                 |
        8          : 445      |*****************************           |
        9          : 207      |*************                           |
        10         : 3        |                                        |"
"     runqlen       : count     distribution
        0          : 2        |                                        |
        1          : 6        |                                        |
        2          : 1        |                                        |
        3          : 3        |                                        |
        4          : 170      |**********                              |
        5          : 641      |****************************************|
        6          : 329      |********************                    |
        7          : 248      |***************                         |
        8          : 421      |**************************              |
        9          : 142      |********                                |
        10         : 5        |                                        |
        11         : 2        |                                        |
        12         : 1        |                                        |"
"     runqlen       : count     distribution
        3          : 3        |                                        |
        4          : 13       |                                        |
        5          : 406      |****************************            |
        6          : 565      |****************************************|
        7          : 526      |*************************************   |
        8          : 256      |******************                      |
        9          : 169      |***********                             |
        10         : 24       |*                                       |
        11         : 3        |                                        |
        12         : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 2        |                                        |
        1          : 13       |                                        |
        2          : 0        |                                        |
        3          : 4        |                                        |
        4          : 99       |*****                                   |
        5          : 269      |***************                         |
        6          : 410      |***********************                 |
        7          : 710      |****************************************|
        8          : 405      |**********************                  |
        9          : 20       |*                                       |
        10         : 0        |                                        |
        11         : 11       |                                        |"
"     runqlen       : count     distribution
        0          : 2        |                                        |
        1          : 3        |                                        |
        2          : 0        |                                        |
        3          : 2        |                                        |
        4          : 166      |********                                |
        5          : 371      |******************                      |
        6          : 181      |*********                               |
        7          : 245      |************                            |
        8          : 795      |****************************************|
        9          : 193      |*********                               |
        10         : 7        |                                        |"
"     runqlen       : count     distribution
        0          : 5        |                                        |
        1          : 10       |                                        |
        2          : 1        |                                        |
        3          : 18       |*                                       |
        4          : 246      |*******************                     |
        5          : 286      |**********************                  |
        6          : 283      |**********************                  |
        7          : 289      |**********************                  |
        8          : 292      |**********************                  |
        9          : 512      |****************************************|
        10         : 26       |**                                      |
        11         : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 2        |                                        |
        1          : 4        |                                        |
        2          : 0        |                                        |
        3          : 8        |                                        |
        4          : 304      |***********************                 |
        5          : 362      |****************************            |
        6          : 508      |****************************************|
        7          : 337      |**************************              |
        8          : 372      |*****************************           |
        9          : 59       |****                                    |
        10         : 5        |                                        |
        11         : 3        |                                        |
        12         : 4        |                                        |
        13         : 0        |                                        |
        14         : 1        |                                        |
        15         : 2        |                                        |"
"     runqlen       : count     distribution
        0          : 220      |********                                |
        1          : 105      |****                                    |
        2          : 117      |****                                    |
        3          : 482      |*******************                     |
        4          : 1002     |****************************************|
        5          : 46       |*                                       |
        6          : 5        |                                        |
"
"     runqlen       : count     distribution
        0          : 276      |******************************          |
        1          : 117      |*************                           |
        2          : 143      |***************                         |
        3          : 98       |**********                              |
        4          : 100      |***********                             |
        5          : 140      |***************                         |
        6          : 198      |**********************                  |
        7          : 324      |************************************    |
        8          : 359      |****************************************|
        9          : 164      |******************                      |
"
"     runqlen       : count     distribution
        0          : 4        |                                        |
        1          : 0        |                                        |
        2          : 1        |                                        |
        3          : 9        |                                        |
        4          : 0        |                                        |
        5          : 98       |******                                  |
        6          : 211      |*************                           |
        7          : 351      |**********************                  |
        8          : 635      |****************************************|
        9          : 615      |**************************************  |
        10         : 28       |*                                       |
        11         : 6        |                                        |
        12         : 4        |                                        |"
"     runqlen       : count     distribution
        0          : 641      |*******************************         |
        1          : 89       |****                                    |
        2          : 117      |*****                                   |
        3          : 263      |************                            |
        4          : 820      |****************************************|
        5          : 42       |**                                      |
        6          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 270      |********************************        |
        1          : 246      |*****************************           |
        2          : 312      |*************************************   |
        3          : 238      |****************************            |
        4          : 309      |************************************    |
        5          : 337      |****************************************|
        6          : 153      |******************                      |
        7          : 88       |**********                              |
        8          : 6        |                                        |
"
"     runqlen       : count     distribution
        0          : 104      |*****                                   |
        1          : 162      |********                                |
        2          : 245      |************                            |
        3          : 594      |*****************************           |
        4          : 801      |****************************************|
        5          : 51       |**                                      |
"
"     runqlen       : count     distribution
        0          : 14       |                                        |
        1          : 17       |*                                       |
        2          : 138      |*********                               |
        3          : 217      |**************                          |
        4          : 150      |*********                               |
        5          : 221      |**************                          |
        6          : 571      |*************************************   |
        7          : 609      |****************************************|
        8          : 15       |                                        |
        9          : 10       |                                        |
        10         : 1        |                                        |"
"     runqlen       : count     distribution
        0          : 363      |****************************************|
        1          : 271      |*****************************           |
        2          : 160      |*****************                       |
        3          : 233      |*************************               |
        4          : 290      |*******************************         |
        5          : 248      |***************************             |
        6          : 169      |******************                      |
        7          : 194      |*********************                   |
        8          : 29       |***                                     |
        9          : 9        |                                        |"
"     runqlen       : count     distribution
        0          : 146      |**********                              |
        1          : 128      |********                                |
        2          : 352      |************************                |
        3          : 580      |****************************************|
        4          : 519      |***********************************     |
        5          : 181      |************                            |
        6          : 53       |***                                     |
        7          : 12       |                                        |
        8          : 1        |                                        |
"
"     runqlen       : count     distribution
        0          : 46       |****                                    |
        1          : 202      |*********************                   |
        2          : 375      |****************************************|
        3          : 346      |************************************    |
        4          : 135      |**************                          |
        5          : 92       |*********                               |
        6          : 77       |********                                |
        7          : 124      |*************                           |
        8          : 157      |****************                        |
        9          : 131      |*************                           |
        10         : 183      |*******************                     |
        11         : 87       |*********                               |
        12         : 4        |                                        |
        13         : 0        |                                        |"
"     runqlen       : count     distribution
        1          : 1        |                                        |
        2          : 0        |                                        |
        3          : 0        |                                        |
        4          : 0        |                                        |
        5          : 15       |*                                       |
        6          : 99       |**********                              |
        7          : 119      |************                            |
        8          : 137      |**************                          |
        9          : 378      |****************************************|
        10         : 350      |*************************************   |
        11         : 281      |*****************************           |
        12         : 312      |*********************************       |
        13         : 237      |*************************               |
        14         : 41       |****                                    |"
"     runqlen       : count     distribution
        4          : 39       |****                                    |
        5          : 64       |******                                  |
        6          : 105      |**********                              |
        7          : 45       |****                                    |
        8          : 126      |*************                           |
        9          : 288      |******************************          |
        10         : 248      |*************************               |
        11         : 201      |********************                    |
        12         : 230      |************************                |
        13         : 383      |****************************************|
        14         : 165      |*****************                       |
        15         : 66       |******                                  |
        16         : 6        |                                        |"
"     runqlen       : count     distribution
        6          : 34       |**                                      |
        7          : 59       |*****                                   |
        8          : 203      |*****************                       |
        9          : 217      |******************                      |
        10         : 323      |***************************             |
        11         : 339      |*****************************           |
        12         : 465      |****************************************|
        13         : 234      |********************                    |
        14         : 69       |*****                                   |
        15         : 3        |                                        |
        16         : 0        |                                        |"
"     runqlen       : count     distribution
        0          : 208      |*********************************       |
        1          : 176      |****************************            |
        2          : 121      |*******************                     |
        3          : 247      |****************************************|
        4          : 133      |*********************                   |
        5          : 116      |******************                      |
        6          : 141      |**********************                  |
        7          : 196      |*******************************         |
        8          : 76       |************                            |
        9          : 9        |*                                       |
        10         : 2        |                                        |
        11         : 10       |*                                       |
        12         : 11       |*                                       |
        13         : 41       |******                                  |
        14         : 43       |******                                  |
        15         : 68       |***********                             |
        16         : 108      |*****************                       |
        17         : 26       |****                                    |
"
"""

raw_labels = """0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1"""


def read_file(file_path):
    """
    读取文件内容并返回字符串。

    :param file_path: 文件路径
    :return: 文件内容字符串
    """
    with open(file_path, 'r') as file:
        content = file.read()
    return content

def convert_to_formatted_string(content):
    """
    将读取的内容转换成所需的字符串格式。

    :param content: 文件内容字符串
    :return: 格式化后的字符串
    """
    # 使用正则表达式提取所需的部分
    pattern = re.compile(r'\[(\d+), (\d+)\)\s+(\d+)\s+\|(.*?)\|')
    matches = pattern.findall(content)

    # 构建格式化后的字符串
    formatted_lines = []
    for i, (start, end, count, distribution) in enumerate(matches):
        runqlen = i
        count = int(count)
        distribution = distribution.strip()
        formatted_line = f"{runqlen:>8}          : {count:>8}     |{distribution}|"
        formatted_lines.append(formatted_line)

    # 拼接所有行
    formatted_string = "     runqlen       : count     distribution\n" + "\n".join(formatted_lines)
    return formatted_string

def train_model(texts, labels):
    """
    训练逻辑回归模型。

    :param texts: 训练文本列表
    :param labels: 标签列表
    :return: 训练好的模型
    """
    X_train = [extract_features(text) for text in texts]
    y_train = labels
    model = make_pipeline(StandardScaler(), LogisticRegression())
    model.fit(X_train, y_train)
    return model

def predict(model, texts):
    """
    使用训练好的模型进行预测。

    :param model: 训练好的模型
    :param texts: 需要预测的文本列表
    :return: 预测结果列表
    """
    X_new = [extract_features(text) for text in texts]
    predictions = model.predict(X_new)
    return predictions

def evaluate_model(model, texts, labels):
    """
    评估模型在训练集上的准确率。

    :param model: 训练好的模型
    :param texts: 训练文本列表
    :param labels: 标签列表
    :return: 模型在训练集上的准确率
    """
    X_train = [extract_features(text) for text in texts]
    y_train = labels
    predictions = model.predict(X_train)
    accuracy = accuracy_score(y_train, predictions)
    return accuracy

def main():
    # 使用正则表达式分割字符串
    pattern = re.compile(r'"(.*?)"', re.DOTALL)
    matches = pattern.findall(raw_texts)

    # 去除多余的换行符和空格
    texts = [match.strip() for match in matches]

    # 将字符串按行分割并转换为整数列表
    labels = list(map(int, raw_labels.splitlines()))

    # 训练模型
    model = train_model(texts, labels)

    # 评估模型准确率
    accuracy = evaluate_model(model, texts, labels)
    print(f"Model accuracy on training set: {accuracy:.2f}")

    # 预测新样本
    file_path = 'bt.log'
    content = read_file(file_path)
    formatted_string = convert_to_formatted_string(content)
    new_texts = [formatted_string]
    predictions = predict(model, new_texts)
    print("Predictions for new samples:", predictions)

if __name__ == "__main__":
    main()
